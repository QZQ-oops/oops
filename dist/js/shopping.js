"use strict";$(function(){var n=cookie.get("user");n?($(".ming").html(n+"欢迎您"),$(".outlog").css("display","block"),$(".onlog").css("display","none"),$(".tuichu").click(function(){var n=new Date;n.setTime(n.getTime()-1),document.cookie="user="+escape("")+";expires="+n.toUTCString()+";path=/YY",$(".outlog").css("display","none"),$(".onlog").css("display","block"),window.location.reload()})):($(".outlog").css("display","none"),$(".onlog").css("display","block")),n?($(".empty_box").css("display","none"),$(".cart-main").css("display","block"),$.ajax({type:"post",url:"../api/shoppingCart.php",data:"uid="+n,success:function(n){var e=JSON.parse(n).datalist.map(function(n){return'\n                            <ul class="item-content clearfix" data-id="'+n.deleid+'">\n                                <li class="td td-chk">\n                                    <div class="td-inner">\n                                        <label class="cart-checkbox">\n                                            <input type="checkbox" class="danxuan">\n                                        </label>\n                                    </div>\n                                </li>\n                                <li class="td td-item">\n                                    <div class="td-inner">\n                                        <div class="item-pic">\n                                            <a href="">\n                                                <img onerror="imgERROR(this, \'no_pic_50_50.jpg\')" src="../images/list/'+n.simg1+'" class="itempic">\n                                            </a>\n                                        </div>\n                                        <div class="item-info">\n                                            <a href="" class="item-title">\n                                            '+n.title+'\n                                            </a>\n                                        </div>\n                                    </div>\n                                </li>\n                                <li class="td td-price">\n                                    <div class="td-inner">'+n.price+'\n                                    </div>\n                                </li>\n                                <li class="td td-amount">\n                                    <div class="td-inner">\n                                        <div class="item-amount ">\n                                            <input type="button" class="btn-reduce" value="-">\n                                            <input itype="1" id="" class="text-amount" maxlength="3" value=" '+n.nums+'" type="text">\n                                            <input type="button" class="btn-plus" value="+">\n                                        </div>\n                                        <div class="amount-msg" style="display: none;" id="">\n                                            商品数量已修改为&nbsp;\n                                            <span style="color: red;">1</span>\n                                            <em></em>\n                    \n                                        </div>\n                                    </div>\n                                </li>\n                                <li class="td td-weight">\n                                    <div class="td-inner">\n                                        <em class="number">'+n.zhongliang+'</em>\n                                    </div>\n                                </li>\n                                <li class="td td-location">\n                    \n                                    <div class="td-inner">\n                                        有货\n                                    </div>\n                                    <div style="color: red;">(不支持平安健康卡支付)</div>\n                                </li>\n                                <li class="td td-sum">\n                                    <div class="td-inner red  xiaoji">\n                                    '+n.price+'\n                                    </div>\n                                </li>\n                                <li class="td td-op">\n                                    <div class="td-inner">\n                                        <a id="favorites_1179343" class="fav" href="javascript:void(0);">收藏</a>\n                                        <a href="javascript:;" class="deleteButton">删除</a>\n                                        <a href="javascript:;" class="deleteButton">找相似</a>\n                                    </div>\n                                </li>\n                            </ul>'}).join("");$(".item-body").html(e);var t=1*$(".text-amount").val(),i=1*$(".number").html(),a=1*$(".xiaoji").html();function c(){var t=[];t=[],$(".danxuan").each(function(n,e){$(".danxuan").eq(n).prop("checked")&&t.push(n)});var e=0,i=0;t.forEach(function(n){1*$(".text-amount").eq(n).val(),e+=1*$(".xiaoji").eq(n).text().slice(2),i+=1*$(".number").eq(n).html()}),$(".zong").html(e.toFixed(2)),$(".zongzhongliang").html(i.toFixed(2)+"kg")}$(".number").val(t*i),$(".xiaoji").html(t*a),$(".item-body").on("click",".btn-reduce",function(){var n=1*$(this).next().val();--n<1&&(n=1),$(this).next().val(n),c(),$(this).parent().parent().parent().next().children().children().html(i*n.toFixed(2)),$(this).parent().parent().parent().next().next().next().children().html("￥&nbsp;"+a*n.toFixed(2))}),$(".item-body").on("click",".btn-plus",function(){var n=1*$(this).prev().val();n++,$(this).prev().val(n),c(),$(this).parent().parent().parent().next().children().children().html(i*n.toFixed(2)),$(this).parent().parent().parent().next().next().next().children().html("￥&nbsp;"+a*n.toFixed(2))}),$(".item-body").on("click",".deleteButton",function(){if(confirm("您确定要删除吗?")){var n=$(this).parent().parent().parent().get(0).dataset.id;$.ajax({type:"get",url:"../api/delete.php",data:"deleid="+n,success:function(n){JSON.parse(n).code&&($(this).parent().parent().parent().remove(),location.reload())}})}}),$(".cart-checkbox-selected input").on("click",function(){console.log($(".cart-checkbox-selected input")),$(".cart-checkbox-selected input").prop("checked")?$(".danxuan").prop("checked",!0):$(".danxuan").prop("checked",!1),c()}),$(".danxuan").on("click",function(){$(".danxuan:checked").size()==$(".danxuan").size()?$(".cart-checkbox-selected input").prop("checked",!0):$(".cart-checkbox-selected input").prop("checked",!1),c()}),$(".quanxuan").on("click",function(){$(".quanxuan").prop("checked")?$(".danxuan").prop("checked",!0):$(".danxuan").prop("checked",!1),c()}),$("#clearAllCart").on("click",function(){var n=confirm("您确定要清空购物车吗?"),e=cookie.get("user");n&&$.ajax({type:"get",url:"../api/clear_cat.php",data:"uid="+e,success:function(n){var e=JSON.parse(n);console.log(e.code),e.code&&($(this).prev().remove(),location.reload())}})})}})):($(".empty_box").css("display","block"),$(".cart-main").css("display","none"))});